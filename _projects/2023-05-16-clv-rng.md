---
layout: page
title: On efficient generation of continuous (non)-contractual data
description: Some mathematical cleverness for data generation
importance: 2
img: assets/img/value-oss/pymc-logo.png
---

### 1. Overview

Customer lifetime value (CLV) models are statistical methods that study the ``lifetime'' retention of a customer base. In continuous models, customer engagement is ongoing, that is that their participation is not subject to any obligations; they can quit or make purchases at *any time*. In discrete CLVs, transactions (or lack of) or churn can only occur at pre-determined times.

The statistical analysis of discrete models is simpler, as we only need to focus on the pre-determined time points where customers may act. Continuous models are more complex, hence more interesting from a modelling perspective. In particular, the set of non-contractual models offer a broader statistical playground since customer churn is implicit in the data.

## 2. Methods

### 2.1 Notation

Let $0 < \tilde T_1 < \tilde T_2, \dots$ be the uncensored purchase times and $C$ be the censoring time. We define $\tilde N(t) = \sum_{j} 1[\tilde T \leq t]$ is a counting process for the number of purchases in $[0, t]$ if there were no censoring and $N(t) = \operatorname{min}\big(N(t), C\big)$ the number of purchases that we can observe.

Because customers can dropout/die after any purchase, we define $D_j \sim \operatorname{Bernouilli}(p)$ to be the dropout indicator after the $j$ th purchase. We define these dropouts for every purchase times even if customers are already "dead". More specifically, for BG/NBD, we assume that $\tilde N(t)$ is a homogenous Poisson process with hazard $\lambda$, hence $T_j - T_{j-1} \stackrel{\small{\text{i.i.d.}}}{\sim} \operatorname{Exp}(\lambda)$. Formally, $( \tilde T_j, D_j)_{j \geq 1}$ characterizes a marked point process (MPP); the MPP framework is too much for this blogpost but it is useful in extending CLV models to incorporate time-varying covariates.

### 2.2 Poisson Processes

Homogeneous poisson processes offer good properties since the intensity is constant with respect to time. Some important properties follow from homogeneous Poisson Process:

- $T_j - T_{j-1} \sim \operatorname{Exp}(\lambda)$;
- $P\big(N([a, b]) = n\big) = \frac{e^{-\lambda(b - a)}(\lambda(b - a))^n}{n!}$, which is the probability mass function of a Poisson distribution with rate $\lambda(b-a)$.

While both properties are correct, one may be more advantageous to use in more practical settings. For instance, when it comes to generating data, characterizing the interarrival times works better as it permits sequential updating of the intensity with respect to time. However, data must be generated sequentially, that is $T_1, D_1$, followed by $T_2, D_2$, etc. When $\lambda$ is constant, one can simulate directly from a Poisson distribution and the observation times follow from their uniformity of the interval of interest.

### 2.3 Incorporating Dropouts

The Poisson Process properties assume no censoring. Right censoring with $C$ is easy to handle; we simply define the interval of interest to be $[0, C]$. However, participants may dropout at any moment following a purchase. We leverage uniformity of observation times to achieve this.

Dropouts $D_j$'s are defined independently of their observation times.

## 3. Simulation Study

### 4. Relaxing Assumptions

CLV models can be easily extended by relaxing some of the model-based assumptions above. However, this often entails a significant amount of additional complexity which can be difficult to grasp both on a theoretical and pragmatic level.
